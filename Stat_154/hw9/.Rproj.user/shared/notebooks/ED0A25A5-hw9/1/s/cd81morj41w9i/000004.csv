"0","lda_fit <- function(X, y)"
"0","{"
"0","  # X: predictor matrix, y: response matrix (factor)"
"0","  y <- factor(y)"
"0","  n = length(y)"
"0","  k = length(levels(y))"
"0","  pi_hat = rep(0, k)"
"0","  mu_hat = matrix(0, nrow = k, ncol = ncol(X))"
"0","  sigma_hat = matrix(0, nrow = ncol(X), ncol = ncol(X))"
"0","  count = 0"
"0","  for (i in levels(y))"
"0","  {"
"0","    count = count+1"
"0","    subset = X[y == i, ]"
"0","    pi_hat[count] = nrow(subset) / n"
"0","    mu_hat[count, ] = apply(subset, 2, mean)"
"0","    for (k in 1:nrow(subset))"
"0","    {"
"0","      sigma_hat = sigma_hat + t(as.matrix(subset[k,] - mu_hat[count, ])) %*% (as.matrix(subset[k,] - mu_hat[count, ])) / (n-k)"
"0","    }"
"0","  }"
"0","  return(list(""pi"" = pi_hat,""mu"" = mu_hat,""sigma"" = sigma_hat))"
"0","}"
