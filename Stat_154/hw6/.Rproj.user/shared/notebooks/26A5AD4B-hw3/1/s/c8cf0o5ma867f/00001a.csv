"0","# Regression Adjustment"
"0","ycontrol = lm(y.control~x.control, data = data.frame(y.control = dataxy[,'y.control'], x.control = dataxy[,'x.control']))$residuals"
"0","ytreat = lm(y.treat~x.treat, data = data.frame(y.treat = dataxy[,'y.treatment'], x.treat = dataxy[,'x.treatment']))$residuals"
"0","difference = ytreat - ycontrol"
"0","n.pairs    = length(difference)"
"0","abs.diff   = abs(difference)"
"0","t.obs      = mean(difference)"
"0","t.ran      = sapply(1:2^8, "
"0","                    function(x){ "
"0","                      sum(MP_enumerate(x, 8)*abs.diff) "
"0","                      })/n.pairs"
"0","w.obs = wilcox.test(ytreat, ycontrol, paired = TRUE)$statistic"
"0","w.ran      = sapply(1:2^8, "
"0","                    function(x){ "
"0","                      wilcox.test(ytreat*(-MP_enumerate(x, 8)), ycontrol*(MP_enumerate(x, 8)), paired = TRUE)$statistic"
"0","                      }, simplify = TRUE)"
"0","pvalue     = mean(t.ran>=t.obs)"
"0","pvalue"
"1","[1]"
"1"," 0.5"
"1","
"
"0","pw = mean(w.ran >= w.obs)"
"0","pw"
"1","[1]"
"1"," 0.6796875"
"1","
"
"0","hist(t.ran, breaks = 50, col = ""grey"", border = NA,"
"0","     xlab = expression(hat(tau)), "
"0","     ylab = """", yaxt = 'n', "
"0","     main = ""randomization distribution - MPstar data"")"
