"0","MP_enumerate = function(i, n.pairs = 15) "
"0","{"
"0"," a = 2^((n.pairs-1):0)"
"0"," b = 2*a"
"0"," 2*sapply(i-1, "
"0","          function(x) "
"0","            as.integer((x %% b)>=a)) - 1"
"0","}"
"0","## Darwin's data from Fisher's book"
"0","ytreat     = c(188, 96, 168, 176, 153, "
"0","               172, 177, 163, 146, 173, "
"0","               186, 168, 177, 184, 96)"
"0","ycontrol   = c(139, 163, 160, 160, 147, "
"0","               149, 149, 122, 132, 144, "
"0","               130, 144, 102, 124, 144)"
"0","difference = ytreat - ycontrol"
"0","n.pairs    = length(difference)"
"0","abs.diff   = abs(difference)"
"0","w.obs = wilcox.test(ytreat, ycontrol, paired = TRUE)$statistic"
"0","w.ran      = sapply(1:2^15, "
"0","                    function(x){ "
"0","                      wilcox.test(ytreat*(-MP_enumerate(x)), ycontrol*(MP_enumerate(x)), paired = TRUE)$statistic"
"0","                      }, simplify = TRUE)"
"0","pvalue     = mean(w.ran>=w.obs)"
"0","hist(w.ran, breaks = 50, col = ""grey"", border = NA,"
"0","     xlab = expression(hat(tau)), "
"0","     ylab = """", yaxt = 'n', "
"0","     main = ""randomization distribution - Darwin's data"")"
