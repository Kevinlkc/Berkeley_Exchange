"0","MSE = matrix(rep(0,50), nrow = 5)"
"0","for (i in 1:5){"
"0","  num = 1"
"0","  for (j in seq(0,0.45,0.05)){"
"0","    trainingSet2 <- trainingSet %>%"
"0","      filter(fold != i)"
"0","    test <- trainingSet %>%"
"0","      filter(fold == i)"
"0","    test <- test %>%"
"0","      select(-fold)"
"0","    RR <- glmnet(as.matrix(trainingSet %>% select(-pH)), as.matrix(trainingSet$pH), alpha = 1, lambda = j)"
"0","    "
"0","    pred <- test %>% pull(-pH) %*% t(RR$beta)"
"0","    MSE[i,num] = mean((pred - test$pH)^2)"
"0","    num = num + 1"
"0","  }"
"0","}"
"0","MSE"
"1","    "
"1","     [,1]"
"1","     [,2]"
"1","      [,3]"
"1","      [,4]"
"1","      [,5]"
"1","      [,6]"
"1","      [,7]"
"1","      [,8]"
"1","      [,9]"
"1","     [,10]"
"1","
[1,]"
"1"," 1.455642"
"1"," 1.132612"
"1"," 1.0126872"
"1"," 1.0119625"
"1"," 1.0134148"
"1"," 1.0163146"
"1"," 1.0192474"
"1"," 1.0211878"
"1"," 1.0211878"
"1"," 1.0211878"
"1","
[2,]"
"1"," 1.422119"
"1"," 1.098596"
"1"," 0.9806104"
"1"," 0.9779649"
"1"," 0.9784222"
"1"," 0.9802916"
"1"," 0.9822505"
"1"," 0.9836113"
"1"," 0.9836113"
"1"," 0.9836113"
"1","
[3,]"
"1"," 1.455385"
"1"," 1.104366"
"1"," 0.9746211"
"1"," 0.9733167"
"1"," 0.9746263"
"1"," 0.9774987"
"1"," 0.9804222"
"1"," 0.9823738"
"1"," 0.9823738"
"1"," 0.9823738"
"1","
[4,]"
"1"," 1.558482"
"1"," 1.170184"
"1"," 1.0259583"
"1"," 1.0251501"
"1"," 1.0269283"
"1"," 1.0304479"
"1"," 1.0340053"
"1"," 1.0363568"
"1"," 1.0363568"
"1"," 1.0363568"
"1","
[5,]"
"1"," 1.549760"
"1"," 1.166320"
"1"," 1.0242056"
"1"," 1.0231302"
"1"," 1.0247422"
"1"," 1.0280683"
"1"," 1.0314399"
"1"," 1.0336778"
"1"," 1.0336778"
"1"," 1.0336778"
"1","
"
"0","which.min(apply(MSE,2,mean))"
"1","[1]"
"1"," 4"
"1","
"
