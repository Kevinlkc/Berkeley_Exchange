"0","# Then Consider PLSR"
"0","MSE = matrix(rep(0,50), nrow = 5)"
"0","for (i in 1:5){"
"0","  for (j in 1:10){"
"0","    trainingSet2 <- trainingSet %>%"
"0","      filter(fold != i)"
"0","    test <- trainingSet %>%"
"0","      filter(fold == i)"
"0","    test <- test %>%"
"0","      select(-fold)"
"0","    PLSR <- plsr(pH ~ .-fold, data = trainingSet2, scale = T)"
"0","    "
"0","    pred <- test %>% pull(-pH) %*% t(PLSR$coefficients[,,j])"
"0","    MSE[i,j] = mean((pred - test$pH)^2)"
"0","  }"
"0","}"
"0","MSE"
"1","    "
"1","      [,1]"
"1","      [,2]"
"1","     [,3]"
"1","     [,4]"
"1","     [,5]"
"1","     [,6]"
"1","     [,7]"
"1","     [,8]"
"1","     [,9]"
"1","    [,10]"
"1","
[1,]"
"1"," 1.0101883"
"1"," 1.0217006"
"1"," 1.087010"
"1"," 1.182066"
"1"," 1.390803"
"1"," 1.534493"
"1"," 1.580732"
"1"," 1.582230"
"1"," 1.583709"
"1"," 1.583648"
"1","
[2,]"
"1"," 0.9799203"
"1"," 0.9930872"
"1"," 1.053468"
"1"," 1.132007"
"1"," 1.293288"
"1"," 1.405062"
"1"," 1.444401"
"1"," 1.445383"
"1"," 1.446463"
"1"," 1.446462"
"1","
[3,]"
"1"," 0.9726598"
"1"," 0.9873839"
"1"," 1.057005"
"1"," 1.143957"
"1"," 1.325813"
"1"," 1.472759"
"1"," 1.522640"
"1"," 1.523695"
"1"," 1.525275"
"1"," 1.525265"
"1","
[4,]"
"1"," 1.0260617"
"1"," 1.0408644"
"1"," 1.119630"
"1"," 1.192451"
"1"," 1.360262"
"1"," 1.527328"
"1"," 1.587118"
"1"," 1.588689"
"1"," 1.590706"
"1"," 1.590715"
"1","
[5,]"
"1"," 1.0243296"
"1"," 1.0406417"
"1"," 1.120392"
"1"," 1.194936"
"1"," 1.358698"
"1"," 1.514567"
"1"," 1.560088"
"1"," 1.561702"
"1"," 1.563439"
"1"," 1.563414"
"1","
"
"0","which.min(apply(MSE,2,mean))"
"1","[1]"
"1"," 1"
"1","
"
"0","# Find the lowest MSE"
