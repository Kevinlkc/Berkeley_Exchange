"0","# For each model, for each fold, calculate the best tuning parameter"
"0","# First Consider PCR"
"0","trainingSet <- trainingSet %>% select(-instant)"
"0","MSE = matrix(rep(0,50), nrow = 5)"
"0","for (i in 1:5){"
"0","  for (j in 1:10){"
"0","    trainingSet2 <- trainingSet %>%"
"0","      filter(fold != i)"
"0","    test <- trainingSet %>%"
"0","      filter(fold == i)"
"0","    test <- test %>%"
"0","      select(-fold)"
"0","    PCR <- pcr(pH ~ .-fold, data = trainingSet2, scale = T)"
"0","    "
"0","    pred <- test %>% pull(-pH) %*% t(PCR$coefficients[,,j])"
"0","    MSE[i,j] = mean((pred - test$pH)^2)"
"0","  }"
"0","}"
"0","MSE"
"1","    "
"1","      [,1]"
"1","      [,2]"
"1","      [,3]"
"1","      [,4]"
"1","      [,5]"
"1","      [,6]"
"1","      [,7]"
"1","      [,8]"
"1","      [,9]"
"1","    [,10]"
"1","
[1,]"
"1"," 1.0241265"
"1"," 1.0118974"
"1"," 1.0028959"
"1"," 1.0173202"
"1"," 1.0300965"
"1"," 1.0141734"
"1"," 1.0165315"
"1"," 1.0186808"
"1"," 1.0209749"
"1"," 1.583648"
"1","
[2,]"
"1"," 0.9860859"
"1"," 0.9780937"
"1"," 0.9747830"
"1"," 0.9845182"
"1"," 0.9973073"
"1"," 0.9875324"
"1"," 0.9875855"
"1"," 0.9894150"
"1"," 0.9948502"
"1"," 1.446462"
"1","
[3,]"
"1"," 0.9852706"
"1"," 0.9733906"
"1"," 0.9647165"
"1"," 0.9813756"
"1"," 0.9955942"
"1"," 0.9807201"
"1"," 0.9814434"
"1"," 0.9833008"
"1"," 0.9865554"
"1"," 1.525265"
"1","
[4,]"
"1"," 1.0398539"
"1"," 1.0267183"
"1"," 1.0164500"
"1"," 1.0345030"
"1"," 1.0529819"
"1"," 1.0367592"
"1"," 1.0347687"
"1"," 1.0389113"
"1"," 1.0450465"
"1"," 1.590715"
"1","
[5,]"
"1"," 1.0362342"
"1"," 1.0244861"
"1"," 1.0150055"
"1"," 1.0311245"
"1"," 1.0489792"
"1"," 1.0336471"
"1"," 1.0356983"
"1"," 1.0381105"
"1"," 1.0421664"
"1"," 1.563414"
"1","
"
"0","which.min(apply(MSE,2,mean))"
"1","[1]"
"1"," 3"
"1","
"
"0","# Find the lowest MSE"
