"0","# Similarly, Do the same for RR and Lasso"
"0","MSE = matrix(rep(0,50), nrow = 5)"
"0","for (i in 1:5){"
"0","  num = 1"
"0","  for (j in seq(0,9,1)){"
"0","    trainingSet2 <- trainingSet %>%"
"0","      filter(fold != i)"
"0","    test <- trainingSet %>%"
"0","      filter(fold == i)"
"0","    test <- test %>%"
"0","      select(-fold)"
"0","    RR <- glmnet(as.matrix(trainingSet %>% select(-pH)), as.matrix(trainingSet$pH), alpha = 0, lambda = j)"
"0","    "
"0","    pred <- test %>% pull(-pH) %*% t(RR$beta)"
"0","    MSE[i,num] = mean((pred - test$pH)^2)"
"0","    num = num + 1"
"0","  }"
"0","}"
"0","MSE"
"1","    "
"1","     [,1]"
"1","      [,2]"
"1","      [,3]"
"1","      [,4]"
"1","      [,5]"
"1","      [,6]"
"1","      [,7]"
"1","      [,8]"
"1","      [,9]"
"1","     [,10]"
"1","
[1,]"
"1"," 1.455642"
"1"," 1.0163941"
"1"," 1.0152964"
"1"," 1.0157688"
"1"," 1.0163431"
"1"," 1.0168512"
"1"," 1.0172788"
"1"," 1.0176366"
"1"," 1.0179378"
"1"," 1.0181938"
"1","
[2,]"
"1"," 1.422119"
"1"," 0.9821723"
"1"," 0.9802675"
"1"," 0.9802436"
"1"," 0.9804832"
"1"," 0.9807506"
"1"," 0.9809966"
"1"," 0.9812127"
"1"," 0.9814002"
"1"," 0.9815629"
"1","
[3,]"
"1"," 1.455385"
"1"," 0.9780701"
"1"," 0.9766603"
"1"," 0.9770399"
"1"," 0.9775735"
"1"," 0.9780607"
"1"," 0.9784762"
"1"," 0.9788267"
"1"," 0.9791233"
"1"," 0.9793763"
"1","
[4,]"
"1"," 1.558482"
"1"," 1.0304846"
"1"," 1.0291913"
"1"," 1.0297755"
"1"," 1.0304768"
"1"," 1.0310955"
"1"," 1.0316154"
"1"," 1.0320502"
"1"," 1.0324160"
"1"," 1.0327268"
"1","
[5,]"
"1"," 1.549760"
"1"," 1.0283646"
"1"," 1.0269713"
"1"," 1.0274763"
"1"," 1.0281204"
"1"," 1.0286965"
"1"," 1.0291836"
"1"," 1.0295923"
"1"," 1.0299371"
"1"," 1.0302305"
"1","
"
"0","apply(MSE,2,mean)"
"1"," [1]"
"1"," 1.488277"
"1"," 1.007097"
"1"," 1.005677"
"1"," 1.006061"
"1"," 1.006599"
"1"," 1.007091"
"1"," 1.007510"
"1"," 1.007864"
"1"," 1.008163"
"1"," 1.008418"
"1","
"
"0","which.min(apply(MSE,2,mean))"
"1","[1]"
"1"," 3"
"1","
"
