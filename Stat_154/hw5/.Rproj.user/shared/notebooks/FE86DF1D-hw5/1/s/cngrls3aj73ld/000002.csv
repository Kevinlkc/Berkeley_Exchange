"0","# Hold-out Method"
"0","set.seed(54321)"
"0","subs <- sample(365, 292)"
"0","# Subtracting Training and Test Set"
"0","trainingSet <- data_day[subs, ]"
"0","testSet <- data_day[-subs, ]"
"0","# Train the Model"
"0","model_1 <- lm(registered ~ temp, data = trainingSet)"
"0","model_2 <- lm(registered ~ temp + I(temp^2), data = trainingSet)"
"0","model_3 <- lm(registered ~ temp + I(temp^2) + workingday, data = trainingSet)"
"0","model_4 <- lm(registered ~ temp + I(temp^2) + workingday + clearday, data = trainingSet)"
"0","model_5 <- lm(registered ~ temp + I(temp^2) + workingday + clearday + temp*workingday, data = trainingSet)"
"0","# Compute the training MSE"
"0","MSE <- rep(0,5)"
"0","MSE[1] = mean(model_1$residuals^2)"
"0","MSE[2] = mean(model_2$residuals^2)"
"0","MSE[3] = mean(model_3$residuals^2)"
"0","MSE[4] = mean(model_4$residuals^2)"
"0","MSE[5] = mean(model_5$residuals^2)"
"0","# Compute the test MSE"
"0","test_MSE = rep(0,5)"
"0","testX = cbind(1, testSet$temp)"
"0","test_MSE[1] = mean((testSet[, ""registered""] - testX %*% model_1$coefficients)^2)"
"0","testX = cbind(1, testSet$temp, testSet$temp^2)"
"0","test_MSE[2] = mean((testSet[, ""registered""] - testX %*% model_2$coefficients)^2)"
"0","testX = cbind(1, testSet$temp, testSet$temp^2, testSet$workingday)"
"0","test_MSE[3] = mean((testSet[, ""registered""] - testX %*% model_3$coefficients)^2)"
"0","testX = cbind(1, testSet$temp, testSet$temp^2, testSet$workingday, testSet$clearday)"
"0","test_MSE[4] = mean((testSet[, ""registered""] - testX %*% model_4$coefficients)^2)"
"0","testX = cbind(1, testSet$temp, testSet$temp^2, testSet$workingday, testSet$clearday, testSet$temp * testSet$workingday)"
"0","test_MSE[5] = mean((testSet[, ""registered""] - testX %*% model_5$coefficients)^2)"
