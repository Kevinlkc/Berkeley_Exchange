"0","within_variance <- function(x, group){"
"0","  group <- factor(group)"
"0","  result = matrix(0, nrow = ncol(x), ncol = ncol(x))"
"0","  for (i in levels(group)){"
"0","    subgroup = x[group == i,]"
"0","    result = result + (nrow(subgroup)-1) * total_variance(subgroup) / (nrow(x) - 1)"
"0","  }"
"0","  return(result)"
"0","}"
"0","within_variance(iris[ ,1:4], iris[ ,5])"
"1","            "
"1"," Sepal.Length"
"1"," Sepal.Width"
"1"," Petal.Length"
"1"," Petal.Width"
"1","
Sepal.Length"
"1","   0.26145101"
"1","  0.09147651"
"1","   0.16526577"
"1","  0.03788591"
"1","
Sepal.Width "
"1","   0.09147651"
"1","  0.11383893"
"1","   0.05450201"
"1","  0.03227114"
"1","
Petal.Length"
"1","   0.16526577"
"1","  0.05450201"
"1","   0.18270201"
"1","  0.04209262"
"1","
Petal.Width "
"1","   0.03788591"
"1","  0.03227114"
"1","   0.04209262"
"1","  0.04131946"
"1","
"
"0","# Here we can verify our decompostion formula"
"0","round(total_variance(iris[,1:4]) - within_variance(iris[ ,1:4], iris[ ,5]) - between_variance(iris[,1:4], iris[,5]))"
"1","            "
"1"," Sepal.Length"
"1"," Sepal.Width"
"1"," Petal.Length"
"1"," Petal.Width"
"1","
Sepal.Length"
"1","            0"
"1","           0"
"1","            0"
"1","           0"
"1","
Sepal.Width "
"1","            0"
"1","           0"
"1","            0"
"1","           0"
"1","
Petal.Length"
"1","            0"
"1","           0"
"1","            0"
"1","           0"
"1","
Petal.Width "
"1","            0"
"1","           0"
"1","            0"
"1","           0"
"1","
"
