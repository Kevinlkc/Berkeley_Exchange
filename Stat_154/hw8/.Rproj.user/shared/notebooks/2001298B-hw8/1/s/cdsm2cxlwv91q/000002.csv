"0","between_variance <- function(x, group){"
"0","  m <- apply(x, 2, mean)"
"0","  group <- factor(group)"
"0","  result = matrix(0, nrow = ncol(x), ncol = ncol(x))"
"0","  for (i in levels(group)){"
"0","    subgroup = x[group == i, ]"
"0","    result = result + nrow(subgroup) / (nrow(x)-1) *(apply(subgroup, 2, mean) - m) %*% t(apply(subgroup, 2, mean) - m)"
"0","  }"
"0","  return(result)"
"0","}"
"0","between_variance(iris[,1:4], iris[,5])"
"1","    "
"1"," Sepal.Length"
"1"," Sepal.Width"
"1"," Petal.Length"
"1"," Petal.Width"
"1","
[1,]"
"1","    0.4242425"
"1"," -0.13391051"
"1","    1.1090497"
"1","   0.4783848"
"1","
[2,]"
"1","   -0.1339105"
"1","  0.07614049"
"1","   -0.3841584"
"1","  -0.1539105"
"1","
[3,]"
"1","    1.1090497"
"1"," -0.38415839"
"1","    2.9335758"
"1","   1.2535168"
"1","
[4,]"
"1","    0.4783848"
"1"," -0.15391051"
"1","    1.2535168"
"1","   0.5396868"
"1","
"
